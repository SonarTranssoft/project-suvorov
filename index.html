<!doctype html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body>

<script type="text/javascript" src="js/main.js"></script>
<script src="//api.bitrix24.com/api/v1/"></script>
<script>
        BX24.init(function(){
            let arrayOfDeals = getCoordinatesFromDeals()
            console.log(arrayOfDeals);
            function initMap() {

                let map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 3,
                    center: {lat: -28.024, lng: 140.887}
                });

                // Create an array of alphabetical characters used to label the markers.
                let labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

                // Add some markers to the map.
                // Note: The code uses the JavaScript Array.prototype.map() method to
                // create an array of markers based on a given "locations" array.
                // The map() method here has nothing to do with the Google Maps API.
                let markers = locations.map(function(location, i) {
                    return new google.maps.Marker({
                        position: location,
                        label: labels[i % labels.length]
                    });
                });

                // Add a marker clusterer to manage the markers.
                let markerCluster = new MarkerClusterer(map, markers,
                    {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
            }
            let locations = arrayOfDeals;
        });

</script>
<script src="https://unpkg.com/@google/markerclustererplus@5.1.0/dist/markerclustererplus.min.js"></script>
<script defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyASzH9y5Yara69z3gffsfNPJht1z93Kn9o&callback=initMap">
</script>
</body>
</html>